% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/classifyEdgeArtifacts.R
\name{classifyEdgeArtifacts}
\alias{classifyEdgeArtifacts}
\title{Classify Edge Artifacts into Hierarchical Categories}
\usage{
classifyEdgeArtifacts(
  spe,
  qc_metric = "sum_umi",
  samples = "sample_id",
  min_spots = 20,
  name = "edge_artifact",
  exclude_slides = NULL
)
}
\arguments{
\item{spe}{A SpatialExperiment object that has been processed with \code{detectEdgeArtifacts()}.}

\item{qc_metric}{Character string specifying the QC metric column used for validation (default: "sum_umi").
Note: This column must exist, but is not directly used for classification logic.}

\item{samples}{Character string specifying the sample ID column name (default: "sample_id").}

\item{min_spots}{Minimum number of spots for an artifact to be classified as "large" (default: 20).}

\item{name}{Character string matching the \code{name} argument used in \code{detectEdgeArtifacts()} (default: "edge_artifact").}

\item{exclude_slides}{Character vector of slide IDs to exclude from edge detection (default: NULL).
Spots on these slides will be forced to FALSE for edge artifacts.}
}
\value{
A SpatialExperiment object with additional classification columns in \code{colData}:
\itemize{
\item \code{[name]_true_edges}: Logical, indicating edge artifacts after applying slide exclusions.
\item \code{[name]_classification}: Character, containing hierarchical categories:
\itemize{
\item \code{"not_artifact"}: Normal, high-quality spots.
\item \code{"large_edge_artifact"}: Clusters > min_spots touching the slide boundary.
\item \code{"small_edge_artifact"}: Clusters <= min_spots touching the slide boundary.
\item \code{"large_interior_artifact"}: Clusters > min_spots in the tissue interior.
\item \code{"small_interior_artifact"}: Clusters <= min_spots in the tissue interior.
}
}
}
\description{
Classifies detected artifacts based on their location (edge vs. interior)
and size (large vs. small). This function works downstream of \code{detectEdgeArtifacts()}.
}
\details{
\strong{Parameter Recommendations:}

The \code{min_spots} threshold should scale with platform resolution to
represent similar physical artifact sizes:

\itemize{
\item \strong{Standard Visium (55µm bins):} \code{min_spots = 20-40}
\itemize{
\item Physical area: ~0.06-0.12 mm²
\item Rationale: Artifacts <20 spots likely represent isolated noise
\item Typical edge artifacts: 50-200 spots
}

\item \strong{VisiumHD 16µm bins:} \code{min_spots = 100-200}
\itemize{
\item Physical area: ~0.026-0.051 mm² (comparable to Visium)
\item Rationale: Higher density requires proportionally higher threshold
\item Typical edge artifacts: 500-2000 bins
}

\item \strong{VisiumHD 8µm bins:} \code{min_spots = 400-800}
\itemize{
\item Physical area: ~0.026-0.051 mm² (comparable to Visium)
\item Rationale: 4× density of 16µm bins requires 4× threshold
\item Typical edge artifacts: 2000-8000 bins
}
}

\strong{Practical Guideline:} For VisiumHD data, start with:
\code{min_spots = 20 × (55µm / bin_size)²}

This formula maintains constant physical area thresholds across resolutions.

\strong{Context-Specific Tuning:}
\itemize{
\item Increase \code{min_spots} for noisy data (prevents over-flagging small clusters)
\item Decrease \code{min_spots} for high-quality data (captures smaller genuine artifacts)
\item Visualize intermediate results to validate threshold appropriateness
}
}
\examples{
library(SpatialExperiment)
library(S4Vectors)

# --- Create a Mock SPE with "Detected" Results ---
# We simulate the output that detectEdgeArtifacts() would produce
n_spots <- 5
spe <- SpatialExperiment(
    colData = DataFrame(
        sample_id = "sample01",
        sum_umi = rep(100, n_spots), 
        edge_artifact_edge = c(TRUE, TRUE, FALSE, FALSE, FALSE),
        edge_artifact_problem_id = c("Cluster1", "Cluster1", "Cluster2", "Cluster3", NA),
        edge_artifact_problem_size = c(50, 50, 10, 30, 0)
    )
)

# Review the mock scenarios:
# Spot 1: Edge=TRUE, Size=50 -> Expect "large_edge_artifact"
# Spot 2: Edge=TRUE, Size=50 -> Expect "large_edge_artifact"
# Spot 3: Edge=FALSE, Size=10 -> Expect "small_interior_artifact"
# Spot 4: Edge=FALSE, Size=30 -> Expect "large_interior_artifact"
# Spot 5: Edge=FALSE, Size=0  -> Expect "not_artifact"

# --- Run Classification ---
# Set threshold to 20 to separate large/small
spe <- classifyEdgeArtifacts(spe, min_spots = 20, name = "edge_artifact")
table(spe$edge_artifact_classification)
colData(spe)[, c("edge_artifact_problem_size", "edge_artifact_classification")]

}
\seealso{
\code{\link{detectEdgeArtifacts}}
}
