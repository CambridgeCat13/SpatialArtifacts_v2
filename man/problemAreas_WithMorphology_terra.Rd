% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/edge_helper_functions_VisiumHD.R
\name{problemAreas_WithMorphology_terra}
\alias{problemAreas_WithMorphology_terra}
\title{Detect problem areas in VisiumHD data using morphological processing}
\usage{
problemAreas_WithMorphology_terra(
  .xyz,
  uniqueIdentifier = NA,
  min_cluster_size = 5,
  resolution = "8um"
)
}
\arguments{
\item{.xyz}{Data frame with columns: x, y, outlier (binary 0/1)}

\item{uniqueIdentifier}{Character string for cluster ID prefix}

\item{min_cluster_size}{Minimum cluster size in bins (default: 5)}

\item{resolution}{VisiumHD resolution: "8um" or "16um" (default: "8um")}
}
\value{
Data frame with columns: spotcode, clumpID, clumpSize
}
\description{
Terra-optimized implementation for VisiumHD. Uses morphological operations
to connect outlier regions and identify connected components.
}
\examples{
library(terra)

# 1. Create a mock VisiumHD-like coordinate dataframe
# 10x10 grid
coords <- expand.grid(x = 1:10, y = 1:10)
.xyz <- data.frame(
  x = coords$x,
  y = coords$y,
  outlier = 0
)
rownames(.xyz) <- paste0("bin_", 1:100)

# 2. Create a "problem area" (cluster of outliers)
# Make a 3x3 block of outliers in the center
center_mask <- .xyz$x >= 4 & .xyz$x <= 6 & .xyz$y >= 4 & .xyz$y <= 6
.xyz$outlier[center_mask] <- 1

# 3. Run detection
clusters <- problemAreas_WithMorphology_terra(
  .xyz, 
  uniqueIdentifier = "TEST", 
  min_cluster_size = 2,
  resolution = "16um"
)

# Check results
print(clusters)

}
