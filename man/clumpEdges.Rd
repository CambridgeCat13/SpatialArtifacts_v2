% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/edge_helper_functions_visium.R
\name{clumpEdges}
\alias{clumpEdges}
\title{Detect edge dryspots using spatial clustering}
\usage{
clumpEdges(
  .xyz,
  offTissue,
  shifted = FALSE,
  edge_threshold = 0.75,
  min_cluster_size = 40
)
}
\arguments{
\item{.xyz}{Data frame with spot coordinates and QC metrics. Must contain:
\itemize{
\item Column 1: array_row coordinates
\item Column 2: array_col coordinates
\item Column 3: Binary outlier indicator (TRUE/FALSE or 1/0)
\item Row names: Spot identifiers
}}

\item{offTissue}{Character vector of spot identifiers that are off-tissue}

\item{shifted}{Logical indicating whether to apply coordinate adjustment
for hexagonal arrays (default: FALSE)}

\item{edge_threshold}{Numeric value between 0 and 1 specifying the minimum
proportion of border coverage required for edge detection (default: 0.75)}

\item{min_cluster_size}{Numeric value for minimum cluster size in
morphological operations (default: 40)}
}
\value{
Character vector of spot identifiers classified as edge dryspots
}
\description{
Identifies clusters of low-quality spots that touch tissue boundaries,
indicating potential edge dryspot artifacts from incomplete reagent coverage.
}
\details{
The function performs the following steps:
\enumerate{
\item Converts spot coordinates to raster format
\item Applies morphological transformations to connect outlier regions
\item Identifies connected components (clusters)
\item Checks each tissue border (N, S, E, W) for cluster coverage
\item Returns spots from clusters that exceed edge_threshold on any border
}
}
\examples{
# 1. Create a 5x5 grid of mock spot data
spot_data <- data.frame(
  array_row = rep(1:5, each = 5),
  array_col = rep(1:5, times = 5),
  outlier = FALSE
)
rownames(spot_data) <- paste0("spot", 1:25)

# 2. Create an "edge artifact" by flagging the first row as outliers
spot_data$outlier[spot_data$array_row == 1] <- TRUE

# 3. Define off-tissue spots (none in this simple case)
offTissue <- character(0)

# 4. Detect edge dryspots
edge_spots <- clumpEdges(
  spot_data,
  offTissue = offTissue,
  edge_threshold = 0.5,
  min_cluster_size = 3
)
print(edge_spots)

}
